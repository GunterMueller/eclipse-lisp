/* Generated by Eclipse Common Lisp 1.1-HOSTED on cad0.
   Tuesday the fifth of May, 1998, 3:10:15 pm CDT. */
#include <eclipse.h>

clObject cl1MINUS_FUNC(clProto), clAddInteger(clProto),
  clAllocateResource(clProto), clAtomicp(clProto), clCar(clProto),
  clCdr(clProto), clCharacterp(clProto),
  clCharpSimpleBaseString __P((clCharp)), clCons(clProto),
  clDeallocateResource(clProto), clDispatchingPrint(clProto),
  clExtraArgs(clProto), clGeInteger(clProto), cl_SETF_Get(clProto),
  clGetResourceParameters(clProto), cl_SETF_GlobalDeclaration(clProto),
  clList(clProto), clListSTAR(clProto), cl_SETF_MacroFunction(clProto),
  clMakeBroadcastStream(clProto), clMakeHashTable(clProto),
  clMakeKeyword(clProto), clMakeResource(clProto),
  clMakeSymbol(clProto), clMinusp(clProto), clMissingArgs(clProto),
  clNot(clProto), clNull(clProto), clNumberp(clProto),
  clPrintFixnum10(clProto), clResourceParameters(clProto),
  cl_SETF_ResourceParameters(clProto), clSymbolPackage(clProto),
  clSymbolp(clProto), clWriteChar(clProto), clWriteString(clProto),
  clZerop(clProto);

extern clObject clEQ, clLET, clSPECIAL, clstarCIRCULARITY_MAPstar,
  clstarCURRENT_CIRCLEstar, clstarCURRENT_LEVELstar,
  clstarPRINT_GENSYMstar, clstarPRINT_READABLYstar, clATOMICP, clCAR,
  clCDR, clCIRCULARITY_MAP, clCLRHASH, clDEFAULT_RESOURCE_MATCHER,
  clGETHASH, clGLOBAL_VARIABLE, clIDENTITY_REST, clPRINT_CIRCULAR_P,
  clRESOURCE, clSETF, clSUBT, clUSING_RESOURCE,
  clWITH_TWO_CIRCULARITY_PASSES;

static clObject C_hash, C_equal, CONS_0, CONS_1, CONS_2, CONS_3,
  CONS_4, I_0, I_1, I_2, keyCONSTRUCTOR, keyDEINITIALIZER,
  keyINITIALIZER, keyMATCHER, keyNAME, keyTEST, STR_dot___8,
  STR_CONSTRUCTOR__1, STR_DEINITIALIZER__4, STR_INITIALIZER__3,
  STR_MAP__6, STR_MATCHER__5, STR_NAME__0, STR_SINK__7, STR_TEST__2;

clObject clAtomicp clVdecl(_ap)
{ clObject object;
  { clBeginParse(_ap);
    clSetq(object,
           (_clVp(_ap) ? clVpop(_ap) : clMissingArgs(I_1, clEOA)));
    if (_clVp(_ap)) clExtraArgs(clVargs(_ap), clEOA);
    clEndParse(_ap); }
  { clObject L_g395;
    { clObject L_0;
      clSetq(L_0, object);
      clSetq(L_g395, clNumberp(L_0, clEOA)); }
    if (clTrue(L_g395))
      return(clValues1(L_g395));
    else
      { clObject L_g396;
        { clObject L_0;
          clSetq(L_0, object);
          clSetq(L_g396, clCharacterp(L_0, clEOA)); }
        if (clTrue(L_g396))
          return(clValues1(L_g396));
        else
          { clObject L_test__R2;
            { clObject L_0;
              clSetq(L_0, object);
              clSetq(L_test__R2, clSymbolp(L_0, clEOA)); }
            if (clTrue(L_test__R2))
              { clObject L_g397;
                { clObject L_0;
                  clSetq(L_0, object);
                  clSetq(L_g397, clSymbolPackage(L_0, clEOA)); }
                if (clTrue(L_g397))
                  return(clValues1(L_g397));
                else
                  { clObject L_0;
                    { clObject L_g398;
                      clSetq(L_g398,
                             clSymbolValue(clstarPRINT_READABLYstar,
                                           clEOA));
                      clSetq(L_0,
                             (clTrue(L_g398) ?
                              L_g398 :
                              clSymbolValue(clstarPRINT_GENSYMstar,
                                            clEOA))); }
                    return(clNot(L_0, clEOA)); } }
            else return(clValues1(clNIL)); } } } }

static clObject clLambda clVdecl(_ap)
{ clObject L_resource0;
  { clBeginParse(_ap);
    clSetq(L_resource0,
           (_clVp(_ap) ? clVpop(_ap) : clMissingArgs(I_1, clEOA)));
    if (_clVp(_ap)) clExtraArgs(clVargs(_ap), clEOA);
    clEndParse(_ap); }
  { clObject L_object1;
    { clObject L_0;
      clSetq(L_0, clMakeBroadcastStream(clEOA));
      clSetq(L_object1,
             clCons(L_0, clMakeHashTable(keyTEST, clEQ, clEOA),
                    clEOA)); }
    { clObject L_arg408, L_value407;
      clSetq(L_arg408, L_resource0);
      { clObject L_0;
        clSetq(L_0, clCons(L_object1, clList(clEOA), clEOA));
        clSetq(L_value407,
               clCons(L_0,
                      clResourceParameters(L_arg408, clEOA),
                      clEOA)); }
      cl_SETF_ResourceParameters(L_value407, L_arg408, clEOA); }
    return(clValues1(L_object1)); } }

static clObject clLambda_r1 clVdecl(_ap)
{ clObject circularity_map, L_resource0;
  { clBeginParse(_ap);
    clSetq(circularity_map,
           (_clVp(_ap) ? clVpop(_ap) : clMissingArgs(I_1, clEOA)));
    clSetq(L_resource0,
           (_clVp(_ap) ? clVpop(_ap) : clMissingArgs(I_2, clEOA)));
    if (_clVp(_ap)) clExtraArgs(clVargs(_ap), clEOA);
    clEndParse(_ap); }
  { clObject L_form409;
    { clObject L_1, L_0;
      clSetq(L_0, circularity_map);
      clSetq(L_1, L_resource0);
      clSetq(L_form409, clGetResourceParameters(L_0, L_1, clEOA)); }
    if (clTrue(L_form409)) clExtraArgs(L_form409, clEOA);
    { clObject L_0;
      { clObject L_0__R1;
        clSetq(L_0__R1, circularity_map);
        clSetq(L_0, clCdr(L_0__R1, clEOA)); }
      return(clFuncallFunction(clSymbolFunctionValue(clCLRHASH),
                               L_0,
                               clEOA)); } } }

clObject clWithTwoCircularityPasses clVdecl(_ap)
{ clObject L_form, L_ignored, L_g416, stream_var, body;
  { clBeginParse(_ap);
    clSetq(L_form,
           (_clVp(_ap) ? clVpop(_ap) : clMissingArgs(I_1, clEOA)));
    clSetq(L_ignored,
           (_clVp(_ap) ? clVpop(_ap) : clMissingArgs(I_2, clEOA)));
    { clObject L_0;
      clSetq(L_0, L_form);
      clSetq(L_form, clCdr(L_0, clEOA)); }
    if (clTrue(L_form))
      { clObject L_top419;
        { clObject L_0;
          clSetq(L_0, L_form);
          clSetq(L_top419, clCar(L_0, clEOA)); }
        { clObject L_0;
          clSetq(L_0, L_form);
          clSetq(L_form, clCdr(L_0, clEOA)); }
        clSetq(L_g416, L_top419); }
    else clSetq(L_g416, clMissingArgs(I_1, clEOA));
    if (clTrue(L_g416))
      { clObject L_top420;
        { clObject L_0;
          clSetq(L_0, L_g416);
          clSetq(L_top420, clCar(L_0, clEOA)); }
        { clObject L_0;
          clSetq(L_0, L_g416);
          clSetq(L_g416, clCdr(L_0, clEOA)); }
        clSetq(stream_var, L_top420); }
    else clSetq(stream_var, clMissingArgs(I_2, clEOA));
    clSetq(body, L_form);
    if (_clVp(_ap)) clExtraArgs(clVargs(_ap), clEOA);
    clEndParse(_ap); }
  if (clTrue(L_g416))
    { clObject L_0; clSetq(L_0, L_g416); clExtraArgs(L_0, clEOA); }
  { clObject map, sink;
    clSetq(map, clMakeSymbol(STR_MAP__6, clEOA));
    clSetq(sink, clMakeSymbol(STR_SINK__7, clEOA));
    { clObject L_2, L_1;
      clSetq(L_1, clListSTAR(map, CONS_0, clEOA));
      { clObject L_2__R1, L_1__R1;
        { clObject L_0__R2;
          clSetq(L_0__R2,
                 clList(sink, clList(clCAR, map, clEOA), clEOA));
          clSetq(L_1__R1,
                 clList(L_0__R2,
                        clList(clstarCIRCULARITY_MAPstar,
                               clList(clCDR, map, clEOA),
                               clEOA),
                        clEOA)); }
        { clObject L_1__R2;
          { clObject L_1__R3;
            { clObject L_0__R4;
              clSetq(L_0__R4, stream_var);
              clSetq(L_1__R3, clList(L_0__R4, sink, clEOA)); }
            clSetq(L_1__R2, clList(CONS_1, L_1__R3, clEOA)); }
          clSetq(L_2__R1, clListSTAR(clLET, L_1__R2, body, clEOA)); }
        clSetq(L_2,
               clListSTAR(clLET, L_1__R1, L_2__R1, body, clEOA)); }
      return(clList(clUSING_RESOURCE, L_1, L_2, clEOA)); } } }

clObject clPrintCircularP clVdecl(_ap)
{ clObject object, stream, interior_cdr_p;
  { clBeginParse(_ap);
    clSetq(object,
           (_clVp(_ap) ? clVpop(_ap) : clMissingArgs(I_1, clEOA)));
    clSetq(stream,
           (_clVp(_ap) ? clVpop(_ap) : clMissingArgs(I_2, clEOA)));
    clSetq(interior_cdr_p, (_clVp(_ap) ? clVpop(_ap) : clNIL));
    if (_clVp(_ap)) clExtraArgs(clVargs(_ap), clEOA);
    clEndParse(_ap); }
  { clObject L_test;
    { clObject L_0;
      { clObject L_0__R1;
        clSetq(L_0__R1, object);
        clSetq(L_0, clAtomicp(L_0__R1, clEOA)); }
      clSetq(L_test, clNot(L_0, clEOA)); }
    if (clTrue(L_test))
      { clObject id;
        { clObject L_0;
          clSetq(L_0, object);
          clSetq(id,
                 clFuncallFunction(clSymbolFunctionValue(clGETHASH),
                                   L_0,
                                   clSymbolValue(clstarCIRCULARITY_MAPstar,
                                                 clEOA),
                                   clEOA)); }
        if (clTrue(clSymbolValue(clstarCURRENT_CIRCLEstar, clEOA)))
          if (clTrue(clNull(id, clEOA)))
            { { clObject L_arg422, L_arg423;
                clSetq(L_arg422, object);
                clSetq(L_arg423,
                       clSymbolValue(clstarCIRCULARITY_MAPstar,
                                     clEOA));
                clFuncallFunction(clFdefinition(CONS_3, clEOA),
                                  I_0,
                                  L_arg422,
                                  L_arg423,
                                  clEOA); }
              return(clValues1(clNIL)); }
          else
            { if (clTrue(clZerop(id, clEOA)))
                { clObject L_arg425, L_arg426, L_value424;
                  clSetq(L_arg425, object);
                  clSetq(L_arg426,
                         clSymbolValue(clstarCIRCULARITY_MAPstar,
                                       clEOA));
                  { clObject L_0;
                    clSetq(L_0,
                           clSymbolValue(clstarCURRENT_CIRCLEstar,
                                         clEOA));
                    clSetq(L_value424,
                           clSetSymbolValueValue(clstarCURRENT_CIRCLEstar,
                                                 clFuncallFunction(clSymbolFunctionValue(clSUBT),
                                                                   L_0,
                                                                   I_1,
                                                                   clEOA))); }
                  clFuncallFunction(clFdefinition(CONS_3, clEOA),
                                    L_value424,
                                    L_arg425,
                                    L_arg426,
                                    clEOA); }
              return(clValues1(clT)); }
        else if (clTrue(clNull(id, clEOA)))
          return(clValues1(clNIL));
        else if (clTrue(clZerop(id, clEOA)))
          return(clValues1(clNIL));
        else if (clTrue(clMinusp(id, clEOA)))
          { if (clTrue(interior_cdr_p))
              { clObject L_1;
                clSetq(L_1, stream);
                clWriteString(STR_dot___8, L_1, clEOA); }
            { clObject L_1;
              clSetq(L_1, stream);
              clWriteChar(C_hash, L_1, clEOA); }
            { clObject L_1, L_0;
              { clObject L_arg428, L_arg429, L_value427;
                clSetq(L_arg428, object);
                clSetq(L_arg429,
                       clSymbolValue(clstarCIRCULARITY_MAPstar,
                                     clEOA));
                clSetq(L_value427,
                       clFuncallFunction(clSymbolFunctionValue(clSUBT),
                                         I_0,
                                         id,
                                         clEOA));
                clSetq(L_0,
                       clFuncallFunction(clFdefinition(CONS_3, clEOA),
                                         L_value427,
                                         L_arg428,
                                         L_arg429,
                                         clEOA)); }
              clSetq(L_1, stream);
              clPrintFixnum10(L_0, L_1, clEOA); }
            { clObject L_1;
              clSetq(L_1, stream);
              clWriteChar(C_equal, L_1, clEOA); }
            if (clTrue(interior_cdr_p))
              { { clObject STARcurrent_levelSTAR;
                  clSetq(STARcurrent_levelSTAR,
                         cl1MINUS_FUNC(clSymbolValue(clstarCURRENT_LEVELstar,
                                                     clEOA),
                                       clEOA));
                  clDbind(clstarCURRENT_LEVELstar);
                  clSetSymbolValueValue(clstarCURRENT_LEVELstar,
                                        STARcurrent_levelSTAR);
                  { clObject L_1, L_0;
                    { clObject L_1__R1, L_0__R1;
                      { clObject L_0__R2;
                        clSetq(L_0__R2, object);
                        clSetq(L_0__R1, clCar(L_0__R2, clEOA)); }
                      { clObject L_0__R2;
                        clSetq(L_0__R2, object);
                        clSetq(L_1__R1, clCdr(L_0__R2, clEOA)); }
                      clSetq(L_0, clCons(L_0__R1, L_1__R1, clEOA)); }
                    clSetq(L_1, stream);
                    clDispatchingPrint(L_0, L_1, clEOA); }
                  clUnwind(1); }
                return(clValues1(clT)); }
            else return(clValues1(clNIL)); }
        else
          { if (clTrue(interior_cdr_p))
              { clObject L_1;
                clSetq(L_1, stream);
                clWriteString(STR_dot___8, L_1, clEOA); }
            { clObject L_1;
              clSetq(L_1, stream);
              clWriteChar(C_hash, L_1, clEOA); }
            { clObject L_1;
              clSetq(L_1, stream);
              clPrintFixnum10(id, L_1, clEOA); }
            { clObject L_1;
              clSetq(L_1, stream);
              clWriteChar(C_hash, L_1, clEOA); }
            return(clValues1(clT)); } }
    else return(clValues1(clNIL)); } }

void clInitCircle __P((void)) 
{ clDbind(clstarPACKAGEstar);
  clDbind(clstarREADTABLEstar);
  clDbind(clstarLOAD_TRUENAMEstar);
  clDbind(clstarLOAD_PATHNAMEstar);
  clSetq(I_1, clIntFixnum(1));
  clSetq(STR_NAME__0, clCharpSimpleBaseString("NAME"));
  clSetq(keyNAME, clMakeKeyword(STR_NAME__0, clEOA));
  clSetq(STR_CONSTRUCTOR__1, clCharpSimpleBaseString("CONSTRUCTOR"));
  clSetq(keyCONSTRUCTOR, clMakeKeyword(STR_CONSTRUCTOR__1, clEOA));
  clSetq(STR_TEST__2, clCharpSimpleBaseString("TEST"));
  clSetq(keyTEST, clMakeKeyword(STR_TEST__2, clEOA));
  clSetq(STR_INITIALIZER__3, clCharpSimpleBaseString("INITIALIZER"));
  clSetq(keyINITIALIZER, clMakeKeyword(STR_INITIALIZER__3, clEOA));
  clSetq(STR_DEINITIALIZER__4,
         clCharpSimpleBaseString("DEINITIALIZER"));
  clSetq(keyDEINITIALIZER, clMakeKeyword(STR_DEINITIALIZER__4, clEOA));
  clSetq(I_2, clIntFixnum(2));
  clSetq(STR_MATCHER__5, clCharpSimpleBaseString("MATCHER"));
  clSetq(keyMATCHER, clMakeKeyword(STR_MATCHER__5, clEOA));
  clSetq(I_0, clIntFixnum(0));
  clSetq(STR_MAP__6, clCharpSimpleBaseString("MAP"));
  clSetq(STR_SINK__7, clCharpSimpleBaseString("SINK"));
  clSetq(CONS_0, clCons(clCIRCULARITY_MAP, clNIL, clEOA));
  clSetq(CONS_2, clCons(I_0, clNIL, clEOA));
  clSetq(CONS_1, clCons(clstarCURRENT_CIRCLEstar, CONS_2, clEOA));
  clSetq(CONS_4, clCons(clGETHASH, clNIL, clEOA));
  clSetq(CONS_3, clCons(clSETF, CONS_4, clEOA));
  clSetq(STR_dot___8, clCharpSimpleBaseString(". "));
  clSetq(C_hash, clIntCharacter('#'));
  clSetq(C_equal, clIntCharacter('='));

  clSetSymbolFunctionValue(clATOMICP,
                           clMakeClosure(0, clAtomicp, clNULL_HOOK));
  (void) clATOMICP;
  cl_SETF_GlobalDeclaration(clT,
                            clstarCURRENT_CIRCLEstar,
                            clGLOBAL_VARIABLE,
                            clSPECIAL,
                            clEOA);
  clSetSymbolValueValue(clstarCURRENT_CIRCLEstar, clNIL);
  (void) clstarCURRENT_CIRCLEstar;
  cl_SETF_GlobalDeclaration(clT,
                            clstarCIRCULARITY_MAPstar,
                            clGLOBAL_VARIABLE,
                            clSPECIAL,
                            clEOA);
  clSetSymbolValueValue(clstarCIRCULARITY_MAPstar, clNIL);
  (void) clstarCIRCULARITY_MAPstar;
  { clObject L_resource0;
    { clObject L_7, L_5, L_3;
      clSetq(L_3, clMakeClosure(0, clLambda, clNULL_HOOK));
      clSetq(L_5, clSymbolFunctionValue(clIDENTITY_REST));
      clSetq(L_7, clMakeClosure(0, clLambda_r1, clNULL_HOOK));
      clSetq(L_resource0,
             clMakeResource(keyNAME,
                            clCIRCULARITY_MAP,
                            keyCONSTRUCTOR,
                            L_3,
                            keyINITIALIZER,
                            L_5,
                            keyDEINITIALIZER,
                            L_7,
                            keyMATCHER,
                            clSymbolFunctionValue(clDEFAULT_RESOURCE_MATCHER),
                            clEOA)); }
    cl_SETF_Get(L_resource0, clCIRCULARITY_MAP, clRESOURCE, clEOA);
    { clObject L_end413, n;
      clSetq(L_end413, (clTrue(clNIL) ? clNIL : I_0));
      clSetq(n, I_0);
      clLabel(l_ITERATE414);
      { clObject L_test;
        { clObject L_1;
          clSetq(L_1, L_end413);
          clSetq(L_test, clGeInteger(n, L_1, clEOA)); }
        if (clTrue(L_test)) clLocalReturn(NIL); }
      clDeallocateResource(clCIRCULARITY_MAP,
                           clAllocateResource(clCIRCULARITY_MAP,
                                              clEOA),
                           clEOA);
      { clObject L_0;
        clSetq(L_0, n);
        clSetq(n, clAddInteger(L_0, I_1, clEOA)); }
      goto l_ITERATE414; }
    clBlockEnd(NIL);
    (void) clCIRCULARITY_MAP; }
  { clObject L_value417;
    clSetq(L_value417,
           clMakeClosure(0, clWithTwoCircularityPasses, clNULL_HOOK));
    cl_SETF_MacroFunction(L_value417,
                          clWITH_TWO_CIRCULARITY_PASSES,
                          clEOA); }
  (void) clWITH_TWO_CIRCULARITY_PASSES;
  clSetSymbolFunctionValue(clPRINT_CIRCULAR_P,
                           clMakeClosure(0,
                                         clPrintCircularP,
                                         clNULL_HOOK));
  (void) clPRINT_CIRCULAR_P;
  clUnwind(4); }
